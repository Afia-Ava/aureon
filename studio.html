<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Design Studio | aureon</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #ffffff;
            color: #3a3a3a;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        .header {
            background: #fff;
            box-shadow: 0 2px 20px rgba(0,0,0,0.05);
            padding: 0.2rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            min-height: 72px;
        }
        .logo {
            font-family: 'Playfair Display', serif;
            font-size: 1.3rem;
            color: #3a3a3a;
            text-decoration: none;
            font-weight: 700;
        }
        .nav-links {
            list-style: none;
            display: flex;
            gap: 1.5rem;
            align-items: center;
            height: 48px;
        }
        .nav-links a {
            text-decoration: none;
            color: #3a3a3a;
            font-weight: 500;
            font-size: 0.98rem;
            transition: color 0.2s;
            padding: 0.1rem 0.5rem;
        }
        .nav-links a:hover {
            color: #d4af37;
        }
        .studio-header {
            background: #ffffff;
            /* box-shadow: 0 2px 20px rgba(0,0,0,0.05); */ /* Remove shade */
            padding: 2rem 0 1rem;
            text-align: left;
        }
        .studio-header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            margin-left: 0;
        }
        .studio-header p {
            color: #6b6b6b;
            font-size: 1.1rem;
        }
        .steps {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin: 2rem 0 3rem;
        }
        .step {
            background: #f0ede8;
            border-radius: 12px;
            padding: 1rem 2rem;
            font-weight: 500;
            color: #3a3a3a;
            box-shadow: 0 2px 10px rgba(0,0,0,0.04);
            display: flex;
            align-items: center;
            gap: 0.7rem;
        }
        .step.active {
            background: #a8b5a0;
            color: #fff;
        }
        .studio-main {
            display: flex;
            gap: 2.5rem;
            align-items: flex-start;
            margin-top: 1.2rem;
        }
        .gallery {
            flex: 0.8;
        }
        .gallery-filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.2rem;
        }
        .gallery-filter {
            background: #e8e4f0;
            border: none;
            border-radius: 20px;
            padding: 0.4rem 1.2rem;
            cursor: pointer;
            color: #3a3a3a;
            font-size: 1rem;
            transition: background 0.2s;
        }
        .gallery-filter.active, .gallery-filter:hover {
            background: #a8b5a0;
            color: #fff;
        }
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
        }
        .base-card {
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 2px 8px rgba(168,181,160,0.07);
            padding: 1.2rem 1rem 1.1rem;
            text-align: center;
            cursor: pointer;
            transition: 
                border 0.22s cubic-bezier(.23,1.02,.45,.98),
                box-shadow 0.22s cubic-bezier(.23,1.02,.45,.98),
                background 0.22s cubic-bezier(.23,1.02,.45,.98),
                transform 0.22s cubic-bezier(.23,1.02,.45,.98);
            position: relative;
            min-width: 120px;
            max-width: 180px;
            border: 2.5px solid transparent;
            margin: 0 auto;
            overflow: visible;
        }
        .base-card.selected,
        .base-card:hover {
            border: 2.5px solid #d4af37;
            box-shadow: 0 8px 32px 0 rgba(212,175,55,0.13), 0 2px 12px 0 rgba(168,181,160,0.10);
            background: linear-gradient(135deg,#fdf6e3 60%,#f7f3e7 100%);
            transform: translateY(-6px) scale(1.045);
            z-index: 2;
        }
        .base-card img {
            width: 64px !important;
            height: 64px !important;
            border-radius: 12px !important;
            margin-bottom: 0.7rem !important;
            object-fit: cover;
            box-shadow: 0 2px 8px #e8e4f0;
        }
        .base-label {
            font-size: 1.08rem;
            font-family: 'Playfair Display', serif;
            color: #a88f3a;
            font-weight: 600;
            margin-bottom: 0.1rem;
        }
        .customizer {
            flex: 2.2;
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 6px 24px rgba(0,0,0,0.07);
            padding: 2.5rem 2rem 1.5rem;
            min-height: 480px;
            margin-top: 1.5rem;
        }
        .customizer-tabs {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .customizer-tab {
            background: #e8e4f0;
            border: none;
            border-radius: 20px;
            padding: 0.5rem 1.5rem;
            cursor: pointer;
            color: #3a3a3a;
            font-size: 1rem;
            transition: background 0.2s;
        }
        .customizer-tab.active, .customizer-tab:hover {
            background: #d4af37;
            color: #fff;
        }
        .customizer-content {
            min-height: 220px;
        }
        .preview-area {
            background: none;
            border-radius: 15px;
            min-height: 320px;
            margin: 2.5rem 0 2rem 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: #a8b5a0;
            width: 100%;
            box-sizing: border-box;
            overflow-x: auto;
        }
        .export-bar {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        .export-btn, .save-btn, .share-btn {
            background: #a8b5a0;
            color: #fff;
            border: none;
            border-radius: 30px;
            padding: 0.7rem 2rem;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s;
        }
        .export-btn:hover, .save-btn:hover, .share-btn:hover {
            background: #d4af37;
        }
        .studio-stepbar {
            display: flex;
            justify-content: flex-start;
            gap: 1rem;
            margin-bottom: 2rem;
            margin-top: 0.5rem;
        }
        .studio-step {
            background: #e8e4f0;
            border: none;
            border-radius: 20px;
            padding: 0.5rem 1.1rem;
            font-size: 0.98rem;
            font-weight: 600;
            color: #3a3a3a;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
        }
        .studio-step.selected, .studio-step:hover {
            background: #d4af37;
            color: #fff;
        }
        .mannequin-3d-container {
            width: 100%;
            max-width: 340px;
            height: auto;
            aspect-ratio: unset;
            margin: 0 auto;
            perspective: 800px;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
            cursor: grab;
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.07);
            box-sizing: border-box;
            position: relative;
        }
        .mannequin-3d-img,
        .dress-overlay-img {
            width: auto;
            height: auto;
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            display: block;
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            margin: auto;
        }
        .mannequin-3d-img {
            z-index: 1;
            position: absolute;
        }
        .dress-overlay-img {
            z-index: 2;
            position: absolute;
            pointer-events: none;
            transition: opacity 0.2s;
        }
        .dress-style-demo-grid {
            display: flex;
            gap: 2rem;
            margin-top: 1.5rem;
            margin-bottom: 1.2rem;
            justify-content: flex-start;
            align-items: flex-end;
        }
        .dress-style-demo-box {
            background: linear-gradient(135deg, #f8f6f2 60%, #e8e4f0 100%);
            border-radius: 18px;
            border: 2.5px solid #e8e4f0;
            box-shadow: 0 4px 18px 0 rgba(212,175,55,0.07), 0 1.5px 8px 0 rgba(168,181,160,0.08);
            padding: 1.1rem 1.1rem 0.8rem 1.1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: 
                border 0.22s cubic-bezier(.23,1.02,.45,.98),
                box-shadow 0.22s cubic-bezier(.23,1.02,.45,.98),
                background 0.22s cubic-bezier(.23,1.02,.45,.98),
                transform 0.22s cubic-bezier(.23,1.02,.45,.98);
            min-width: 72px;
            max-width: 90px;
            position: relative;
            overflow: visible;
        }
        .dress-style-demo-box.selected,
        .dress-style-demo-box:hover {
            border: 2.5px solid #d4af37;
            box-shadow: 0 8px 32px 0 rgba(212,175,55,0.13), 0 2px 12px 0 rgba(168,181,160,0.10);
            background: linear-gradient(135deg, #fdf6e3 60%, #f7f3e7 100%);
            transform: translateY(-6px) scale(1.06);
            z-index: 2;
        }
        .dress-style-demo-imgbox {
            position: relative;
            width: 54px;
            height: 82px;
            margin-bottom: 0.5rem;
            aspect-ratio: 2/3;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(212,175,55,0.06);
            overflow: hidden;
        }
        .demo-mannequin-img,
        .demo-dress-img {
            position: absolute;
            top: 0; left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 10px;
            pointer-events: none;
        }
        .demo-mannequin-img {
            z-index: 1;
            filter: brightness(1.05) grayscale(0.15) contrast(1.08);
        }
        .demo-dress-img {
            z-index: 2;
            filter: drop-shadow(0 2px 6px #d4af3740);
        }
        .dress-style-demo-label {
            font-size: 1.05rem;
            font-family: 'Playfair Display', serif;
            font-weight: 600;
            color: #a88f3a;
            text-align: center;
            letter-spacing: 0.02em;
            margin-top: 0.2rem;
            text-shadow: 0 1px 0 #fff, 0 2px 8px #e8e4f0;
        }
        @media (max-width: 900px) {
            .studio-main { flex-direction: column; }
            .customizer { margin-top: 2rem; }
            .mannequin-3d-container {
                max-width: 90vw;
                height: 60vw;
                min-width: 0;
            }
            .dress-style-demo-grid {
                gap: 1.2rem;
            }
            .dress-style-demo-box {
                min-width: 60px;
                max-width: 70px;
                padding: 0.7rem 0.7rem 0.5rem 0.7rem;
            }
            .dress-style-demo-imgbox {
                width: 38px;
                height: 57px;
            }
        }
        @media (max-width: 600px) {
            .mannequin-3d-container {
                max-width: 98vw;
                height: 65vw;
            }
            .dress-style-demo-grid {
                gap: 0.7rem;
            }
            .dress-style-demo-box {
                min-width: 48px;
                max-width: 60px;
                padding: 0.4rem 0.4rem 0.3rem 0.4rem;
            }
            .dress-style-demo-imgbox {
                width: 28px;
                height: 42px;
            }
        }
        .gallery-search {
            position: relative;
            width: 100%;
            max-width: 340px;
            margin-left: 0;
        }
        #baseSearchInput:focus {
            background: #fff;
            box-shadow: 0 4px 18px #e8e4f0;
            border: 1.5px solid #d4af37;
        }
        @media (max-width: 600px) {
            .gallery-search {
                max-width: 100%;
            }
            #baseSearchInput {
                width: 100% !important;
                min-width: 0;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/three@0.153.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.153.0/examples/js/loaders/OBJLoader.js"></script>
    <!-- Add Firebase App and Auth SDKs in the <head> if not already present -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
</head>
<body>
    <header class="header">
        <nav class="nav container">
            <a href="index.html" class="logo">aureon</a>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="studio.html">Studio</a></li>
                <li><a href="gallery.html">Gallery</a></li>
                <li>
                    <a href="join.html" style="background:#a8b5a0;color:#fff;padding:0.5rem 1.5rem;border-radius:24px;font-weight:600;transition:background 0.2s;">Join</a>
                </li>
            </ul>
        </nav>
    </header>

    <div class="studio-header">
        <div class="container">
            <h1>Design Studio</h1>
        </div>
    </div>
    <div class="container">
        <div class="steps">
            <button class="step active step-nav" data-step="choose-base"><span>1️⃣</span> Choose Base</button>
            <button class="step step-nav" data-step="customize"><span>🎨</span> Customize</button>
            <button class="step step-nav" data-step="export"><span>✨</span> Export</button>
        </div>
        <div class="studio-main">
            <div class="gallery" id="choose-base-step">
                <div class="gallery-search" style="display:flex;justify-content:flex-start;margin-bottom:2.2rem;">
                    <input
                        type="text"
                        id="baseSearchInput"
                        placeholder="  Search base..."
                        style="
                            width: 320px;
                            padding: 0.85rem 1.5rem 0.85rem 3.2rem;
                            border-radius: 28px;
                            border: none;
                            background: #f8f6f2;
                            font-size: 1.08rem;
                            color: #3a3a3a;
                            box-shadow: 0 2px 12px #e8e4f0;
                            outline: none;
                            transition: box-shadow 0.18s, background 0.18s;
                            border: 1.5px solid #ece7d8;
                            margin-left: 0;
                            margin-right: 0;
                            position: relative;
                        "
                    />
                    <span style="
                        position: absolute;
                        left: 1.1rem;
                        top: 50%;
                        transform: translateY(-50%);
                        font-size: 1.2rem;
                        color: #bdbdbd;
                        pointer-events: none;
                        z-index: 2;
                    ">🔍</span>
                </div>
                <div class="gallery-grid" id="baseGalleryGrid" style="gap:2.2rem;">
                    <div class="base-card" data-name="Dress" style="background:linear-gradient(135deg,#fdf6e3 60%,#f7f3e7 100%);box-shadow:0 8px 32px 0 rgba(212,175,55,0.13),0 2px 12px 0 rgba(168,181,160,0.10);border:2.5px solid #d4af37;">
                        <img src="asset/dress-cover.jpg" alt="Dress" style="width:64px;height:64px;border-radius:12px;margin-bottom:0.7rem;object-fit:cover;box-shadow:0 2px 8px #e8e4f0;">
                        <div class="base-label" style="font-size:1.08rem;font-family:'Playfair Display',serif;color:#a88f3a;">Dress</div>
                    </div>
                    <div class="base-card" data-name="Wings" style="background:linear-gradient(135deg,#f8f6f2 60%,#e8e4f0 100%);">
                        <img src="asset/wings-cover.jpg" alt="Wings" style="width:64px;height:64px;border-radius:12px;margin-bottom:0.7rem;object-fit:cover;box-shadow:0 2px 8px #e8e4f0;">
                        <div class="base-label" style="font-size:1.08rem;font-family:'Playfair Display',serif;color:#a88f3a;">Wings</div>
                    </div>
                    <div class="base-card" data-name="Jacket" style="background:linear-gradient(135deg,#f8f6f2 60%,#e8e4f0 100%);">
                        <img src="asset/jacket-cover.jpg" alt="Jacket" style="width:64px;height:64px;border-radius:12px;margin-bottom:0.7rem;object-fit:cover;box-shadow:0 2px 8px #e8e4f0;">
                        <div class="base-label" style="font-size:1.08rem;font-family:'Playfair Display',serif;color:#a88f3a;">Jacket</div>
                    </div>
                    <div class="base-card" data-name="Tote Bag" style="background:linear-gradient(135deg,#f8f6f2 60%,#e8e4f0 100%);">
                        <img src="asset/totebag-cover.png" alt="Tote Bag" style="width:64px;height:64px;border-radius:12px;margin-bottom:0.7rem;object-fit:cover;box-shadow:0 2px 8px #e8e4f0;">
                        <div class="base-label" style="font-size:1.08rem;font-family:'Playfair Display',serif;color:#a88f3a;">Tote Bag</div>
                    </div>
                </div>
                <div style="width:100%;display:flex;justify-content:center;">
                    <button class="next-btn" style="margin-top:2.5rem;margin-bottom:5.5rem;padding:1.1rem 2.8rem;font-size:1.13rem;background:#d4af37;color:#fff;border:none;border-radius:30px;cursor:pointer;box-shadow:0 4px 18px 0 rgba(212,175,55,0.13);font-family:'Playfair Display',serif;font-weight:600;">Next</button>
                </div>
            </div>
            <div class="customizer" id="customize-step" style="display:none;">
                <div class="customizer-flex" style="display:flex;gap:2.5rem;align-items:flex-start;">
                    <div class="customizer-left" style="flex:1;min-width:220px;">
                        <div class="studio-stepbar" style="margin-bottom:2rem;">
                            <button class="studio-step selected" id="studio-step-style-btn">Dress Style</button>
                            <button class="studio-step">Colors</button>
                            <button class="studio-step">Movement Style</button>
                            <button class="studio-step">Mood Modes</button>
                        </div>
                        <div class="customizer-content">
                            <div id="style-title"><strong>Dress Style:</strong> Pick your dress style here.</div>
                            <div id="style-options-container">
                                <!-- Dress styles (only for Dress) -->
                                <div class="dress-style-demo-grid style-options" data-base="Dress" style="display:none;">
                                    <div class="dress-style-demo-box" data-style="style1">
                                        <div class="dress-style-demo-imgbox">
                                            <img src="asset/dress-mannequin.jpg" alt="Mannequin" class="demo-mannequin-img" />
                                            <img src="asset/style1.png" alt="Style 1" class="demo-dress-img" />
                                        </div>
                                        <div class="dress-style-demo-label">Style 1</div>
                                    </div>
                                    <div class="dress-style-demo-box" data-style="style2">
                                        <div class="dress-style-demo-imgbox">
                                            <img src="asset/dress-mannequin.jpg" alt="Mannequin" class="demo-mannequin-img" />
                                            <img src="asset/style2.png" alt="Style 2" class="demo-dress-img" />
                                        </div>
                                        <div class="dress-style-demo-label">Style 2</div>
                                    </div>
                                    <div class="dress-style-demo-box" data-style="style3">
                                        <div class="dress-style-demo-imgbox">
                                            <img src="asset/dress-mannequin.jpg" alt="Mannequin" class="demo-mannequin-img" />
                                            <img src="asset/style3.png" alt="Style 3" class="demo-dress-img" />
                                        </div>
                                        <div class="dress-style-demo-label">Style 3</div>
                                    </div>
                                    <div class="dress-style-demo-box" data-style="style4">
                                        <div class="dress-style-demo-imgbox">
                                            <img src="asset/dress-mannequin.jpg" alt="Mannequin" class="demo-mannequin-img" />
                                            <img src="asset/style4.png" alt="Style 4" class="demo-dress-img" />
                                        </div>
                                        <div class="dress-style-demo-label">Style 4</div>
                                    </div>
                                </div>
                                <!-- Wings styles (only for Wings) -->
                                <div class="dress-style-demo-grid style-options" data-base="Wings" style="display:none;">
                                    <div class="dress-style-demo-box" data-style="wing1">
                                        <div class="dress-style-demo-imgbox">
                                            <img src="asset/wings-cover.jpg" alt="Wings" class="demo-mannequin-img" />
                                            <img src="asset/wing1.png" alt="Wing 1" class="demo-dress-img" />
                                        </div>
                                        <div class="dress-style-demo-label">Wing 1</div>
                                    </div>
                                    <div class="dress-style-demo-box" data-style="wing2">
                                        <div class="dress-style-demo-imgbox">
                                            <img src="asset/wings-cover.jpg" alt="Wings" class="demo-mannequin-img" />
                                            <img src="asset/wing2.png" alt="Wing 2" class="demo-dress-img" />
                                        </div>
                                        <div class="dress-style-demo-label">Wing 2</div>
                                    </div>
                                    <div class="dress-style-demo-box" data-style="wing3">
                                        <div class="dress-style-demo-imgbox">
                                            <img src="asset/wings-cover.jpg" alt="Wings" class="demo-mannequin-img" />
                                            <img src="asset/wing3.png" alt="Wing 3" class="demo-dress-img" />
                                        </div>
                                        <div class="dress-style-demo-label">Wing 3</div>
                                    </div>
                                </div>
                                <!-- Jacket styles (only for Jacket) -->
                                <div class="dress-style-demo-grid style-options" data-base="Jacket" style="display:none;">
                                    <div class="dress-style-demo-box" data-style="jacket1">
                                        <div class="dress-style-demo-imgbox">
                                            <img src="asset/jacket-cover.jpg" alt="Jacket" class="demo-mannequin-img" />
                                            <img src="asset/jacket1.png" alt="Jacket 1" class="demo-dress-img" />
                                        </div>
                                        <div class="dress-style-demo-label">Jacket 1</div>
                                    </div>
                                    <div class="dress-style-demo-box" data-style="jacket2">
                                        <div class="dress-style-demo-imgbox">
                                            <img src="asset/jacket-cover.jpg" alt="Jacket" class="demo-mannequin-img" />
                                            <img src="asset/jacket2.png" alt="Jacket 2" class="demo-dress-img" />
                                        </div>
                                        <div class="dress-style-demo-label">Jacket 2</div>
                                    </div>
                                </div>
                                <!-- Tote Bag styles (only for Tote Bag) -->
                                <div class="dress-style-demo-grid style-options" data-base="Tote Bag" style="display:none;">
                                    <div class="dress-style-demo-box" data-style="bag1">
                                        <div class="dress-style-demo-imgbox">
                                            <img src="asset/totebag-cover.png" alt="Tote Bag" class="demo-mannequin-img" />
                                            <img src="asset/bag1.png" alt="Bag 1" class="demo-dress-img" />
                                        </div>
                                        <div class="dress-style-demo-label">Bag 1</div>
                                    </div>
                                    <div class="dress-style-demo-box" data-style="bag2">
                                        <div class="dress-style-demo-imgbox">
                                            <img src="asset/totebag-cover.png" alt="Tote Bag" class="demo-mannequin-img" />
                                            <img src="asset/bag2.png" alt="Bag 2" class="demo-dress-img" />
                                        </div>
                                        <div class="dress-style-demo-label">Bag 2</div>
                                    </div>
                                    <div class="dress-style-demo-box" data-style="bag3">
                                        <div class="dress-style-demo-imgbox">
                                            <img src="asset/totebag-cover.png" alt="Tote Bag" class="demo-mannequin-img" />
                                            <img src="asset/bag3.png" alt="Bag 3" class="demo-dress-img" />
                                        </div>
                                        <div class="dress-style-demo-label">Bag 3</div>
                                    </div>
                                </div>
                            </div>
                            <div class="color-options" id="color-options" style="display:none; margin-top:2rem;">
                                <div style="font-weight:600;margin-bottom:1rem;">Pick a color palette:</div>
                                <div style="display:flex;gap:1.2rem;flex-wrap:wrap;">
                                    <div class="color-palette" data-palette="pastel"
                                        style="display:flex;align-items:center;gap:0.3rem;cursor:pointer;padding:0.5rem 1rem;border-radius:14px;border:2px solid #ece7d8;">
                                        <span style="width:22px;height:22px;background:#f7cac9;border-radius:50%;display:inline-block;"></span>
                                        <span style="width:22px;height:22px;background:#b5ead7;border-radius:50%;display:inline-block;"></span>
                                        <span style="width:22px;height:22px;background:#fff5ba;border-radius:50%;display:inline-block;"></span>
                                        <span style="margin-left:0.7rem;font-size:1rem;color:#6b6b6b;">Pastel</span>
                                    </div>
                                    <div class="color-palette" data-palette="neon"
                                        style="display:flex;align-items:center;gap:0.3rem;cursor:pointer;padding:0.5rem 1rem;border-radius:14px;border:2px solid #ece7d8;">
                                        <span style="width:22px;height:22px;background:#39ff14;border-radius:50%;display:inline-block;"></span>
                                        <span style="width:22px;height:22px;background:#ff2079;border-radius:50%;display:inline-block;"></span>
                                        <span style="width:22px;height:22px;background:#00bfff;border-radius:50%;display:inline-block;"></span>
                                        <span style="margin-left:0.7rem;font-size:1rem;color:#6b6b6b;">Neon</span>
                                    </div>
                                    <div class="color-palette" data-palette="earth"
                                        style="display:flex;align-items:center;gap:0.3rem;cursor:pointer;padding:0.5rem 1rem;border-radius:14px;border:2px solid #ece7d8;">
                                        <span style="width:22px;height:22px;background:#a8b5a0;border-radius:50%;display:inline-block;"></span>
                                        <span style="width:22px;height:22px;background:#e8e4f0;border-radius:50%;display:inline-block;"></span>
                                        <span style="width:22px;height:22px;background:#d4af37;border-radius:50%;display:inline-block;"></span>
                                        <span style="margin-left:0.7rem;font-size:1rem;color:#6b6b6b;">Earth</span>
                                    </div>
                                    <div class="color-palette" data-palette="mono"
                                        style="display:flex;align-items:center;gap:0.3rem;cursor:pointer;padding:0.5rem 1rem;border-radius:14px;border:2px solid #ece7d8;">
                                        <span style="width:22px;height:22px;background:#222;border-radius:50%;display:inline-block;"></span>
                                        <span style="width:22px;height:22px;background:#888;border-radius:50%;display:inline-block;"></span>
                                        <span style="width:22px;height:22px;background:#fff;border-radius:50%;display:inline-block;border:1px solid #ccc;"></span>
                                        <span style="margin-left:0.7rem;font-size:1rem;color:#6b6b6b;">Mono</span>
                                    </div>
                                </div>
                            </div>
                            <!-- Stitch options -->
                            <div class="stitch-options" id="stitch-options" style="display:none; margin-top:2rem;">
                                <div style="font-weight:600;margin-bottom:1rem;">Pick your thread color:</div>
                                <div id="thread-color-palette" style="display:flex;gap:1.2rem;flex-wrap:wrap;margin-bottom:1.5rem;">
                                    <div class="thread-color" data-color="#d4af37" style="width:32px;height:32px;border-radius:50%;background:#d4af37;border:2px solid #ece7d8;cursor:pointer;"></div>
                                    <div class="thread-color" data-color="#a8b5a0" style="width:32px;height:32px;border-radius:50%;background:#a8b5a0;border:2px solid #ece7d8;cursor:pointer;"></div>
                                    <div class="thread-color" data-color="#e8e4f0" style="width:32px;height:32px;border-radius:50%;background:#e8e4f0;border:2px solid #ece7d8;cursor:pointer;"></div>
                                    <div class="thread-color" data-color="#ff2079" style="width:32px;height:32px;border-radius:50%;background:#ff2079;border:2px solid #ece7d8;cursor:pointer;"></div>
                                    <div class="thread-color" data-color="#222" style="width:32px;height:32px;border-radius:50%;background:#222;border:2px solid #ece7d8;cursor:pointer;"></div>
                                </div>
                                <div style="font-weight:600;margin-bottom:1rem;">Pick a stitch style:</div>
                                <div id="thread-style-palette" style="display:flex;gap:1.2rem;flex-wrap:wrap;">
                                    <div class="stitch-palette" data-stitch="zigzag"
                                        style="display:flex;flex-direction:column;align-items:center;cursor:pointer;padding:0.7rem 1.2rem;border-radius:14px;border:2px solid #ece7d8;">
                                        <span style="width:38px;height:38px;display:inline-block;background:repeating-linear-gradient(135deg,#d4af37 0 4px,transparent 4px 8px);border-radius:8px;margin-bottom:0.4rem;"></span>
                                        <span style="font-size:1rem;color:#6b6b6b;">Zigzag</span>
                                    </div>
                                    <div class="stitch-palette" data-stitch="chain"
                                        style="display:flex;flex-direction:column;align-items:center;cursor:pointer;padding:0.7rem 1.2rem;border-radius:14px;border:2px solid #ece7d8;">
                                        <span style="width:38px;height:38px;display:inline-block;background:repeating-radial-gradient(circle,#a8b5a0 0 2px,transparent 2px 8px);border-radius:8px;margin-bottom:0.4rem;"></span>
                                        <span style="font-size:1rem;color:#6b6b6b;">Chain</span>
                                    </div>
                                    <div class="stitch-palette" data-stitch="cross"
                                        style="display:flex;flex-direction:column;align-items:center;cursor:pointer;padding:0.7rem 1.2rem;border-radius:14px;border:2px solid #ece7d8;">
                                        <span style="width:38px;height:38px;display:inline-block;position:relative;">
                                            <span style="position:absolute;left:10px;top:10px;width:18px;height:2px;background:#d4af37;transform:rotate(45deg);"></span>
                                            <span style="position:absolute;left:10px;top:10px;width:18px;height:2px;background:#d4af37;transform:rotate(-45deg);"></span>
                                        </span>
                                        <span style="font-size:1rem;color:#6b6b6b;">Cross</span>
                                    </div>
                                    <div class="stitch-palette" data-stitch="blanket"
                                        style="display:flex;flex-direction:column;align-items:center;cursor:pointer;padding:0.7rem 1.2rem;border-radius:14px;border:2px solid #ece7d8;">
                                        <span style="width:38px;height:38px;display:inline-block;position:relative;">
                                            <span style="position:absolute;left:8px;top:28px;width:22px;height:2px;background:#a8b5a0;"></span>
                                            <span style="position:absolute;left:10px;top:18px;width:2px;height:12px;background:#a8b5a0;"></span>
                                            <span style="position:absolute;left:18px;top:18px;width:2px;height:12px;background:#a8b5a0;"></span>
                                            <span style="position:absolute;left:26px;top:18px;width:2px;height:12px;background:#a8b5a0;"></span>
                                        </span>
                                        <span style="font-size:1rem;color:#6b6b6b;">Blanket</span>
                                    </div>
                                    <div class="stitch-palette" data-stitch="running"
                                        style="display:flex;flex-direction:column;align-items:center;cursor:pointer;padding:0.7rem 1.2rem;border-radius:14px;border:2px solid #ece7d8;">
                                        <span style="width:38px;height:38px;display:inline-block;background:repeating-linear-gradient(90deg,#222 0 8px,transparent 8px 16px);border-radius:8px;margin-bottom:0.4rem;"></span>
                                        <span style="font-size:1rem;color:#6b6b6b;">Running</span>
                                    </div>
                                </div>
                                <div style="font-weight:600;margin:1.5rem 0 0.7rem;">Draw your stitch:</div>
                                <div style="display:flex;align-items:center;gap:1.2rem;margin-bottom:1.2rem;">
                                    <div>
                                        <label style="font-size:1rem;font-weight:500;margin-right:0.7rem;">Marker Type:</label>
                                        <select id="marker-type-select" style="padding:0.4rem 1.2rem;border-radius:12px;border:1.5px solid #ece7d8;font-size:1rem;">
                                            <option value="stitch">Stitch</option>
                                            <option value="marker">Marker</option>
                                        </select>
                                    </div>
                                    <button id="undo-stitch-btn" style="background:#e8e4f0;color:#3a3a3a;border:none;border-radius:20px;padding:0.5rem 1.5rem;font-size:1rem;cursor:pointer;">Undo</button>
                                    <button id="redo-stitch-btn" style="background:#e8e4f0;color:#3a3a3a;border:none;border-radius:20px;padding:0.5rem 1.5rem;font-size:1rem;cursor:pointer;">Redo</button>
                                </div>
                                <div id="stitch-canvas-container" style="position:relative;width:100%;max-width:340px;height:510px;background:none;border-radius:18px;box-shadow:0 2px 12px rgba(0,0,0,0.07);margin:0 auto;">
                                    <canvas id="stitch-canvas" width="340" height="510" style="position:absolute;top:0;left:0;width:100%;height:100%;z-index:10;pointer-events:auto;cursor:crosshair;background:transparent;"></canvas>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top:5rem;display:flex;justify-content:flex-start;">
                            <button class="next-btn customize-next-btn" style="padding:0.8rem 2.2rem;font-size:1.05rem;background:#a8b5a0;color:#fff;border:none;border-radius:30px;cursor:pointer;">Next</button>
                        </div>
                    </div>
                    <div class="customizer-right" style="flex:1.2;min-width:0;">
                        <div class="preview-area" id="dress-preview-area" style="position:relative;">
        <div class="mannequin-3d-container" id="mannequin3d" style="width:100%;max-width:340px;height:510px;margin:0 auto;position:relative;">
            <img src="asset/dress-mannequin.jpg" class="mannequin-3d-img" id="mannequin3dimg" alt="Dress Mannequin" draggable="false" style="width:100%;height:100%;object-fit:contain;user-select:none;pointer-events:none;" />
            <img src="asset/style1.png" class="dress-overlay-img" id="dressOverlayImg" alt="Dress Overlay" style="position:absolute;top:0;left:0;width:100%;height:auto;aspect-ratio:340/510;pointer-events:none;z-index:2;display:block;" />
        </div>
    </div>
                    </div>
                </div>
            </div>
            <div class="export-step" id="export-step" style="display:none;">
                <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:320px;padding-bottom:5rem;">
                    <div class="preview-area" style="width:100%;max-width:600px;margin-bottom:2.5rem;">
                        <span>Final Preview</span>
                    </div>
                    <div class="export-bar" style="margin-top:0;">
                        <button class="export-btn">Export Code</button>
                        <button class="save-btn">Save</button>
                        <button class="share-btn">Share</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
    function showStep(step) {
      const chooseBaseStep = document.getElementById('choose-base-step');
      const customizeStep = document.getElementById('customize-step');
      const exportStep = document.getElementById('export-step');
      if (step === 'choose-base') {
        chooseBaseStep.style.display = '';
        customizeStep.style.display = 'none';
        if (exportStep) exportStep.style.display = 'none';
      } else if (step === 'customize') {
        chooseBaseStep.style.display = 'none';
        customizeStep.style.display = '';
        if (exportStep) exportStep.style.display = 'none';
      } else if (step === 'export') {
        chooseBaseStep.style.display = 'none';
        customizeStep.style.display = 'none';
        if (exportStep) exportStep.style.display = '';
      }
      document.querySelectorAll('.steps .step').forEach(btn => btn.classList.remove('active'));
      const activeBtn = document.querySelector('.steps .step-nav[data-step="' + step + '"]');
      if (activeBtn) activeBtn.classList.add('active');
    }
    document.querySelectorAll('.step-nav').forEach(btn => {
      btn.addEventListener('click', function() {
        showStep(this.getAttribute('data-step'));
      });
    });
    document.querySelectorAll('.next-btn, .customize-next-btn').forEach(nextBtn => {
      nextBtn.addEventListener('click', function() {
        showStep('customize');
      });
    });
    document.querySelectorAll('.customize-next-btn').forEach(nextBtn => {
      nextBtn.addEventListener('click', function() {
        showStep('export');
      });
    });
    </script>
    <script>
document.querySelectorAll('.base-card').forEach(card => {
  card.addEventListener('click', function() {
    document.querySelectorAll('.base-card').forEach(c => c.classList.remove('selected'));
    this.classList.add('selected');
  });
});
</script>
    <script>
// Map for overlay images for all bases
const overlayImages = {
    // Dress
    style1: "asset/style1.png",
    style2: "asset/style2.png",
    style3: "asset/style3.png",
    style4: "asset/style4.png",
    // Wings
    wing1: "asset/wing1.png",
    wing2: "asset/wing2.png",
    wing3: "asset/wing3.png",
    // Jacket
    jacket1: "asset/jacket1.png",
    jacket2: "asset/jacket2.png",
    // Tote Bag
    bag1: "asset/bag1.png",
    bag2: "asset/bag2.png",
    bag3: "asset/bag3.png"
};

// Map for style titles
const styleTitles = {
    "Dress": "Dress Style: Pick your dress style here.",
    "Wings": "Wings Style: Pick your wings style here.",
    "Jacket": "Jacket Style: Pick your jacket style here.",
    "Tote Bag": "Bag Style: Pick your bag style here."
};

const styleStepBtnLabels = {
    "Dress": "Dress Style",
    "Wings": "Wings Style",
    "Jacket": "Jacket Style",
    "Tote Bag": "Bag Style"
};

function showStyleOptions(baseName) {
    document.querySelectorAll('.style-options').forEach(opt => {
        // Only show the selected base's style options
        opt.style.display = (opt.getAttribute('data-base') === baseName) ? 'flex' : 'none';
    });
    // Hide all other style options (Dress, Bag, etc.) if Jacket is selected
    if (baseName === "Jacket") {
        document.querySelectorAll('.style-options').forEach(opt => {
            if (opt.getAttribute('data-base') !== "Jacket") {
                opt.style.display = 'none';
            }
        });
    }
    document.querySelectorAll('.style-options').forEach(opt => {
        opt.querySelectorAll('.dress-style-demo-box').forEach(box => box.classList.remove('selected'));
    });
    const firstStyle = document.querySelector('.style-options[data-base="' + baseName + '"] .dress-style-demo-box');
    if (firstStyle) firstStyle.classList.add('selected');
    if (firstStyle) {
        const style = firstStyle.getAttribute('data-style');
        const overlay = document.getElementById('dressOverlayImg');
        if (overlay && overlayImages[style]) {
            overlay.src = overlayImages[style];
            overlay.style.opacity = 1;
        }
    }
    // Update style title
    const styleTitle = document.getElementById('style-title');
    if (styleTitle) {
        styleTitle.innerHTML = styleTitles[baseName] || "Pick your style here.";
    }
    // Update yellow button label
    const styleBtn = document.getElementById('studio-step-style-btn');
    if (styleBtn) {
        styleBtn.textContent = styleStepBtnLabels[baseName] || "Style";
    }
}

// Listen for base selection and update style options
document.querySelectorAll('.base-card').forEach(card => {
    card.addEventListener('click', function() {
        const base = this.getAttribute('data-name');
        showStyleOptions(base);
    });
});

// Listen for style selection and update overlay image
document.getElementById('style-options-container').addEventListener('click', function(e) {
    const box = e.target.closest('.dress-style-demo-box');
    if (!box) return;
    // Remove selected from all in current group
    box.parentElement.querySelectorAll('.dress-style-demo-box').forEach(b => b.classList.remove('selected'));
    box.classList.add('selected');
    const style = box.getAttribute('data-style');
    const overlay = document.getElementById('dressOverlayImg');
    if (overlay && overlayImages[style]) {
        overlay.src = overlayImages[style];
        overlay.style.opacity = 1;
    }
});

// On load, show Dress styles if Dress is selected, else none
window.addEventListener('DOMContentLoaded', function() {
    // ...existing code...
    // Show no style options by default, or show Dress if you want Dress as default
    showStyleOptions(null);
});
    </script>
    <script>
// Search functionality for base cards
document.getElementById('baseSearchInput').addEventListener('input', function() {
    const query = this.value.trim().toLowerCase();
    document.querySelectorAll('#baseGalleryGrid .base-card').forEach(card => {
        const name = card.getAttribute('data-name').toLowerCase();
        card.style.display = name.includes(query) ? '' : 'none';
    });
});
    </script>
    <script>
// Remove 'selected' from all base-cards on load (none selected by default)
window.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.base-card').forEach((c) => {
        c.classList.remove('selected');
        // Remove any custom inline border/background for Dress
        c.style.border = '';
        c.style.background = '';
        c.style.boxShadow = '';
    });
});

// Only one base-card can be selected at a time, and only after click
document.querySelectorAll('.base-card').forEach(card => {
  card.addEventListener('click', function() {
    document.querySelectorAll('.base-card').forEach(c => {
        c.classList.remove('selected');
        // Remove custom highlight styles from all
        c.style.border = '';
        c.style.background = '';
        c.style.boxShadow = '';
    });
    this.classList.add('selected');
    // Optionally, add highlight styles only to the selected card
    this.style.border = '2.5px solid #d4af37';
    this.style.background = 'linear-gradient(135deg,#fdf6e3 60%,#f7f3e7 100%)';
    this.style.boxShadow = '0 8px 32px 0 rgba(212,175,55,0.13),0 2px 12px 0 rgba(168,181,160,0.10)';
  });
});
    </script>
    <script>
// Tab switching for customization steps
const studioSteps = document.querySelectorAll('.studio-stepbar .studio-step');
const styleOptionsContainer = document.getElementById('style-options-container');
const stitchOptions = document.getElementById('stitch-options');

// Replace "Colors" with "Stitch"
if (studioSteps.length > 1) {
    studioSteps[1].textContent = "Stitch";
}

studioSteps.forEach((btn, idx) => {
    btn.addEventListener('click', function() {
        studioSteps.forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        // Show/hide style/stitch options
        if (idx === 0) {
            document.querySelectorAll('.style-options').forEach(opt => opt.style.display = '');
            if (stitchOptions) stitchOptions.style.display = 'none';
        } else if (idx === 1) {
            document.querySelectorAll('.style-options').forEach(opt => opt.style.display = 'none');
            if (stitchOptions) stitchOptions.style.display = 'block';
        } else {
            document.querySelectorAll('.style-options').forEach(opt => opt.style.display = 'none');
            if (stitchOptions) stitchOptions.style.display = 'none';
        }
    });
});

// --- Stitch Drawing Logic with Undo/Redo and Marker Type ---
let selectedThreadColor = "#d4af37";
let selectedStitchStyle = "zigzag";
let markerType = "stitch";
const colorEls = document.querySelectorAll('.thread-color');
const stitchEls = document.querySelectorAll('.stitch-palette');
const stitchCanvas = document.getElementById('stitch-canvas');
const markerTypeSelect = document.getElementById('marker-type-select');
const undoBtn = document.getElementById('undo-stitch-btn');
const redoBtn = document.getElementById('redo-stitch-btn');
let drawing = false;
let lastPoint = null;
let undoStack = [];
let redoStack = [];

// Thread color selection
colorEls.forEach(el => {
    el.addEventListener('click', function() {
        colorEls.forEach(c => c.style.border = '2px solid #ece7d8');
        this.style.border = '2px solid #d4af37';
        selectedThreadColor = this.getAttribute('data-color');
    });
});
if (colorEls[0]) colorEls[0].style.border = '2px solid #d4af37';

// Stitch style selection
stitchEls.forEach(el => {
    el.addEventListener('click', function() {
        stitchEls.forEach(s => s.style.border = '2px solid #ece7d8');
        this.style.border = '2px solid #d4af37';
        selectedStitchStyle = this.getAttribute('data-stitch');
    });
});
if (stitchEls[0]) stitchEls[0].style.border = '2px solid #d4af37';

// Marker type selection
if (markerTypeSelect) {
    markerTypeSelect.addEventListener('change', function() {
        markerType = this.value;
    });
}

// Drawing on canvas (draws directly over the area)
if (stitchCanvas) {
    const ctx = stitchCanvas.getContext('2d');
    function saveState() {
        undoStack.push(stitchCanvas.toDataURL());
        if (undoStack.length > 100) undoStack.shift();
        redoStack.length = 0;
    }
    function restoreState(stackFrom, stackTo) {
        if (stackFrom.length === 0) return;
        stackTo.push(stitchCanvas.toDataURL());
        const img = new window.Image();
        img.onload = function() {
            ctx.clearRect(0, 0, stitchCanvas.width, stitchCanvas.height);
            ctx.drawImage(img, 0, 0);
        };
        img.src = stackFrom.pop();
    }
    stitchCanvas.addEventListener('mousedown', function(e) {
        drawing = true;
        lastPoint = getCanvasPos(e);
        saveState();
    });
    stitchCanvas.addEventListener('mousemove', function(e) {
        if (!drawing) return;
        const pt = getCanvasPos(e);
        if (markerType === "marker") {
            drawMarker(lastPoint, pt, selectedThreadColor, ctx);
        } else {
            drawStitch(lastPoint, pt, selectedThreadColor, selectedStitchStyle, ctx);
        }
        lastPoint = pt;
    });
    stitchCanvas.addEventListener('mouseup', function() {
        drawing = false;
        lastPoint = null;
    });
    stitchCanvas.addEventListener('mouseleave', function() {
        drawing = false;
        lastPoint = null;
    });
    // Touch support
    stitchCanvas.addEventListener('touchstart', function(e) {
        e.preventDefault();
        drawing = true;
        lastPoint = getCanvasPos(e.touches[0]);
        saveState();
    });
    stitchCanvas.addEventListener('touchmove', function(e) {
        e.preventDefault();
        if (!drawing) return;
        const pt = getCanvasPos(e.touches[0]);
        if (markerType === "marker") {
            drawMarker(lastPoint, pt, selectedThreadColor, ctx);
        } else {
            drawStitch(lastPoint, pt, selectedThreadColor, selectedStitchStyle, ctx);
        }
        lastPoint = pt;
    });
    stitchCanvas.addEventListener('touchend', function() {
        drawing = false;
        lastPoint = null;
    });

    // Undo/Redo
    if (undoBtn) {
        undoBtn.addEventListener('click', function() {
            restoreState(undoStack, redoStack);
        });
    }
    if (redoBtn) {
        redoBtn.addEventListener('click', function() {
            restoreState(redoStack, undoStack);
        });
    }
}

function getCanvasPos(e) {
    const rect = stitchCanvas.getBoundingClientRect();
    return {
        x: (e.clientX - rect.left) * (stitchCanvas.width / rect.width),
        y: (e.clientY - rect.top) * (stitchCanvas.height / rect.height)
    };
}

function drawStitch(from, to, color, style, ctx) {
    if (!from || !to) return;
    ctx.save();
    ctx.strokeStyle = color;
    ctx.lineWidth = 3;
    ctx.lineCap = 'round';
    if (style === "zigzag") {
        const steps = 6;
        ctx.beginPath();
        for (let i = 0; i <= steps; i++) {
            const t = i / steps;
            const x = from.x + (to.x - from.x) * t;
            const y = from.y + (to.y - from.y) * t + (i % 2 === 0 ? -6 : 6);
            if (i === 0) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
        }
        ctx.stroke();
    } else if (style === "chain") {
        ctx.setLineDash([6, 8]);
        ctx.beginPath();
        ctx.moveTo(from.x, from.y);
        ctx.lineTo(to.x, to.y);
        ctx.stroke();
        ctx.setLineDash([]);
    } else if (style === "cross") {
        const dist = Math.hypot(to.x - from.x, to.y - from.y);
        const steps = Math.max(2, Math.floor(dist / 18));
        for (let i = 0; i < steps; i++) {
            const t = i / (steps - 1);
            const x = from.x + (to.x - from.x) * t;
            const y = from.y + (to.y - from.y) * t;
            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(Math.atan2(to.y - from.y, to.x - from.x));
            ctx.beginPath();
            ctx.moveTo(-6, -6);
            ctx.lineTo(6, 6);
            ctx.moveTo(-6, 6);
            ctx.lineTo(6, -6);
            ctx.stroke();
            ctx.restore();
        }
    } else if (style === "blanket") {
        const dist = Math.hypot(to.x - from.x, to.y - from.y);
        const steps = Math.max(2, Math.floor(dist / 14));
        for (let i = 0; i < steps; i++) {
            const t = i / (steps - 1);
            const x = from.x + (to.x - from.x) * t;
            const y = from.y + (to.y - from.y) * t;
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x, y + 10);
            ctx.stroke();
        }
    } else if (style === "running") {
        ctx.setLineDash([8, 10]);
        ctx.beginPath();
        ctx.moveTo(from.x, from.y);
        ctx.lineTo(to.x, to.y);
        ctx.stroke();
        ctx.setLineDash([]);
    } else {
        ctx.beginPath();
        ctx.moveTo(from.x, from.y);
        ctx.lineTo(to.x, to.y);
        ctx.stroke();
    }
    ctx.restore();
}

function drawMarker(from, to, color, ctx) {
    if (!from || !to) return;
    ctx.save();
    ctx.strokeStyle = color;
    ctx.lineWidth = 7;
    ctx.lineCap = 'round';
    ctx.globalAlpha = 0.7;
    ctx.beginPath();
    ctx.moveTo(from.x, from.y);
    ctx.lineTo(to.x, to.y);
    ctx.stroke();
    ctx.restore();
}

// Clear button
if (clearBtn && stitchCanvas) {
    clearBtn.addEventListener('click', function() {
        const ctx = stitchCanvas.getContext('2d');
        ctx.clearRect(0, 0, stitchCanvas.width, stitchCanvas.height);
    });
}

// When switching to Stitch tab, show the correct dress overlay in the stitch-canvas-container
studioSteps.forEach((btn, idx) => {
    btn.addEventListener('click', function() {
        studioSteps.forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        // Show/hide style/stitch options
        if (idx === 0) {
            document.querySelectorAll('.style-options').forEach(opt => opt.style.display = '');
            if (stitchOptions) stitchOptions.style.display = 'none';
        } else if (idx === 1) {
            document.querySelectorAll('.style-options').forEach(opt => opt.style.display = 'none');
            if (stitchOptions) stitchOptions.style.display = 'block';

            // Show the current dress overlay in the stitch-canvas-container
            const mainOverlay = document.getElementById('dressOverlayImg');
            const stitchOverlay = document.getElementById('stitchDressOverlayImg');
            if (mainOverlay && stitchOverlay) {
                stitchOverlay.src = mainOverlay.src;
                stitchOverlay.style.opacity = 1;
            }
        } else {
            document.querySelectorAll('.style-options').forEach(opt => opt.style.display = 'none');
            if (stitchOptions) stitchOptions.style.display = 'none';
        }
    });
});
    </script>
    <script>
    // Firebase config for the-aureon project
    const firebaseConfig = {
        apiKey: "AIzaSyCn-1-Lp4Cweu99s68ODDEQOX69isn3ro8",
        authDomain: "the-aureon.firebaseapp.com",
        projectId: "the-aureon",
        storageBucket: "the-aureon.appspot.com",
        messagingSenderId: "685624046929",
        appId: "1:685624046929:web:dummyid"
    };
    if (!firebase.apps || !firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
    }
    const auth = firebase.auth();

    // --- Profile photo logic for nav (shared for all pages) ---
    function updateNavProfile(user) {
        const navLinks = document.querySelector('.nav-links');
        if (!navLinks) return;
        navLinks.querySelectorAll('.nav-profile-photo-li, .nav-join-btn-li').forEach(el => el.remove());
        // Remove any static Join button (for SSR/static HTML)
        navLinks.querySelectorAll('a.nav-join-btn, li').forEach(el => {
            if (
                el.tagName === 'LI' &&
                el.querySelector &&
                el.querySelector('a[href="join.html"]')
            ) {
                el.remove();
            }
        });
        if (user) {
            const li = document.createElement('li');
            li.className = 'nav-profile-photo-li';
            li.style.display = 'flex';
            li.style.alignItems = 'center';
            li.style.height = '100%';
            li.style.margin = '0';
            const img = document.createElement('img');
            img.className = 'nav-profile-photo';
            img.src = user.photoURL || 'https://ui-avatars.com/api/?name=' + encodeURIComponent(user.displayName || user.email || 'A') + '&background=a8b5a0&color=fff&rounded=true&size=48';
            img.alt = 'Profile';
            img.style.width = '38px';
            img.style.height = '38px';
            img.style.borderRadius = '50%';
            img.style.objectFit = 'cover';
            img.style.border = '2px solid #a8b5a0';
            img.style.background = '#a8b5a0';
            img.style.cursor = 'pointer';
            img.title = user.displayName || user.email || 'Profile';
            img.style.display = 'block';
            img.style.margin = '0';
            img.style.verticalAlign = 'middle';
            img.onclick = function() {
                if (confirm('Log out of aureon?')) {
                    auth.signOut();
                }
            };
            li.appendChild(img);
            navLinks.appendChild(li);
        } else {
            const li = document.createElement('li');
            li.className = 'nav-join-btn-li';
            li.style.display = 'flex';
            li.style.alignItems = 'center';
            li.style.height = '100%';
            li.style.margin = '0';
            const a = document.createElement('a');
            a.href = 'join.html';
            a.className = 'nav-join-btn';
            a.style.background = '#a8b5a0';
            a.style.color = '#fff';
            a.style.padding = '0.5rem 1.5rem';
            a.style.borderRadius = '24px';
            a.style.fontWeight = '600';
            a.style.transition = 'background 0.2s';
            a.textContent = 'Join';
            li.appendChild(a);
            navLinks.appendChild(li);
        }
    }

    auth.onAuthStateChanged(function(user) {
        updateNavProfile(user);
    });
    </script>
    <!-- ...existing code... -->
</body>
</html>

